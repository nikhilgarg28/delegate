<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Boss &mdash; Dashboard</title>
<link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
<link rel="apple-touch-icon" href="/static/apple-touch-icon.svg">
<link rel="stylesheet" href="/static/styles.css">
</head>
<body>

<div class="sidebar" id="sidebar">
  <!-- 1. Boss identity bar -->
  <div class="sidebar-boss-bar" id="sidebarBossBar">
    <span class="sidebar-status-dot" id="sidebarStatusDot">●</span>
    <span class="sidebar-boss-label">Boss</span>
  </div>

  <!-- 2. Team selector slot (if approved — see team-selector-sidebar.md Option A) -->
  <!-- <div class="sidebar-widget sidebar-team-widget" id="sidebarTeamSelector">...</div> -->

  <!-- 3. Action Required widget -->
  <div class="sidebar-widget sidebar-action-widget" id="sidebarActions">
    <div class="sidebar-widget-header">
      <span class="sidebar-action-header">
        <span class="sidebar-action-icon">⚡</span>
        <span>Action Required</span>
        <span class="sidebar-action-count" id="sidebarActionCount" style="display:none">0</span>
      </span>
      <a class="sidebar-see-all" onclick="switchTab('tasks')" style="display:none">See All &rarr;</a>
    </div>
    <div class="sidebar-action-list" id="sidebarActionList">
      <div class="sidebar-action-empty">
        <span style="color:var(--accent-green)">✓</span>
        <span>No items need your attention</span>
      </div>
    </div>
  </div>

  <!-- 4. Summary widget (renamed from Status) -->
  <div class="sidebar-widget" id="sidebarSummary">
    <div class="sidebar-widget-header">
      <span>Summary</span>
    </div>
    <div id="sidebarStatusContent">
      <span style="color:var(--text-faint);font-size:12px">Loading...</span>
    </div>
  </div>

  <!-- 5. Agents widget -->
  <div class="sidebar-widget" id="sidebarAgents">
    <div class="sidebar-widget-header">
      <span>Agents</span>
      <a class="sidebar-see-all" onclick="switchTab('agents')">See All &rarr;</a>
    </div>
    <div class="sidebar-agent-list" id="sidebarAgentList"></div>
  </div>

  <!-- 6. Recent Tasks widget -->
  <div class="sidebar-widget" id="sidebarTasks">
    <div class="sidebar-widget-header">
      <span>Recent Tasks</span>
      <a class="sidebar-see-all" onclick="switchTab('tasks')">See All &rarr;</a>
    </div>
    <div class="sidebar-task-list" id="sidebarTaskList"></div>
  </div>
</div>

<div class="main">
<div class="header">
  <select class="team-selector" id="teamSelector" onchange="onTeamChange()"></select>
  <div class="tabs">
    <button class="tab active" data-tab="chat" onclick="switchTab('chat')">Chat</button>
    <button class="tab" data-tab="tasks" onclick="switchTab('tasks')">Tasks</button>
    <button class="tab" data-tab="agents" onclick="switchTab('agents')">Agents</button>
  </div>
  <div class="header-actions">
    <button class="mute-toggle" id="muteToggle" onclick="toggleMute()" title="Toggle notification sounds"></button>
    <button class="theme-toggle" id="themeToggle" onclick="cycleTheme()" title="Toggle theme"></button>
  </div>
</div>
<div class="content">
  <div id="chat" class="panel active">
    <div class="chat-filters">
      <div class="filter-search-wrap">
        <svg class="filter-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="6" r="4.5"/><line x1="9.5" y1="9.5" x2="13" y2="13"/></svg>
        <input type="text" class="filter-search" id="chatFilterSearch" placeholder="Search messages..." oninput="onChatSearchInput()">
      </div>
      <span class="filter-label">From</span>
      <select id="chatFilterFrom" onchange="onChatFilterChange()">
        <option value="">Anyone</option>
      </select>
      <span class="filter-label">To</span>
      <select id="chatFilterTo" onchange="onChatFilterChange()">
        <option value="">Anyone</option>
      </select>
      <label><input type="checkbox" id="chatShowEvents" checked onchange="onChatFilterChange()"> Activity</label>
    </div>
    <div class="chat-log" id="chatLog"></div>
    <div class="chat-input-container">
      <div class="chat-input-top">
        <select id="recipient"></select>
      </div>
      <textarea id="msgInput" placeholder="Send a message..." rows="1" onkeydown="handleChatKeydown(event)" oninput="autoResizeTextarea(this)"></textarea>
      <div class="chat-input-actions">
        <button class="mic-btn" id="micBtn" onclick="toggleMic()" title="Voice input" aria-label="Voice input" style="display:none">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="5.5" y="1" width="5" height="9" rx="2.5"/>
            <path d="M3 7.5a5 5 0 0 0 10 0"/>
            <line x1="8" y1="12.5" x2="8" y2="15"/>
            <line x1="5.5" y1="15" x2="10.5" y2="15"/>
          </svg>
        </button>
        <button class="send-btn" id="sendBtn" onclick="sendMsg()" title="Send message" aria-label="Send message">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="8" cy="8" r="7"/>
            <line x1="8" y1="11" x2="8" y2="5"/>
            <polyline points="5.5,7.5 8,5 10.5,7.5"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <div id="tasks" class="panel">
    <div class="task-filters">
      <div class="filter-search-wrap">
        <svg class="filter-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="6" r="4.5"/><line x1="9.5" y1="9.5" x2="13" y2="13"/></svg>
        <input type="text" class="filter-search" id="taskFilterSearch" placeholder="Search tasks..." oninput="onTaskSearchInput()">
      </div>
      <span class="filter-label">Status</span>
      <select id="taskFilterStatus" onchange="onTaskFilterChange()">
        <option value="">All</option>
        <option value="open">Open</option>
        <option value="in_progress">In Progress</option>
        <option value="review">Review</option>
        <option value="needs_merge">Needs Merge</option>
        <option value="merged">Merged</option>
        <option value="done">Done</option>
        <option value="rejected">Rejected</option>
      </select>
      <span class="filter-label">Assignee</span>
      <select id="taskFilterAssignee" onchange="onTaskFilterChange()">
        <option value="">All</option>
      </select>
      <span class="filter-label">Priority</span>
      <select id="taskFilterPriority" onchange="onTaskFilterChange()">
        <option value="">All</option>
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
        <option value="critical">Critical</option>
      </select>
      <span class="filter-label">Repo</span>
      <select id="taskFilterRepo" onchange="onTaskFilterChange()">
        <option value="">All</option>
      </select>
    </div>
    <div id="taskTable"></div>
  </div>
  <div id="agents" class="panel"></div>
</div>
</div>

<div id="diffPanel" class="diff-panel">
  <div class="diff-panel-header">
    <div class="diff-panel-title" id="diffPanelTitle"></div>
    <div class="diff-panel-branch" id="diffPanelBranch"></div>
    <div class="diff-panel-commits" id="diffPanelCommits"></div>
    <button class="diff-panel-close" onclick="closePanel()">&times;</button>
  </div>
  <div class="diff-panel-tabs">
    <button class="diff-tab active" data-dtab="files" onclick="switchDiffTab('files')">Files Changed</button>
    <button class="diff-tab" data-dtab="diff" onclick="switchDiffTab('diff')">Full Diff</button>
  </div>
  <div class="diff-panel-body" id="diffPanelBody"></div>
</div>
<div id="diffBackdrop" class="diff-backdrop" onclick="closePanel()"></div>

<div id="taskPanel" class="task-panel">
  <div class="task-panel-header">
    <div class="task-panel-title-row">
      <span class="task-panel-id" id="taskPanelId"></span>
      <span class="task-panel-title" id="taskPanelTitle"></span>
    </div>
    <div class="task-panel-meta-row">
      <span class="task-panel-status" id="taskPanelStatus"></span>
      <span class="task-panel-assignee" id="taskPanelAssignee"></span>
      <span class="task-panel-priority" id="taskPanelPriority"></span>
    </div>
    <button class="task-panel-close" onclick="closeTaskPanel()">&times;</button>
  </div>
  <div class="task-panel-body" id="taskPanelBody"></div>
</div>
<div id="taskBackdrop" class="task-backdrop" onclick="closeTaskPanel()"></div>

<script src="/static/app.js"></script>
</body>
</html>
